<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon225.png">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BNK 1.1">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–∫–æ–º</title>
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 20px;
            background-color: #121212;
            color: #ffffff;
            transition: all 0.3s ease;
        }
        .light-theme {
            background-color: #f5f5f5;
            color: #121212;
        }
        .container {
            width: 100%;
            max-width: 500px;
            margin-top: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header h1 {
            margin-bottom: 10px;
        }
        .theme-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .theme-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border: 2px solid transparent;
        }
        .theme-icon:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        .theme-icon.active {
            border-color: #ffffff;
            transform: scale(1.1);
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #888FB5;
            border-radius: 5px;
            font-size: 1rem;
            background-color: rgba(255, 255, 255, 0.1);
            color: inherit;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #888FB5;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 20px;
        }
        .buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #888FB5;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .buttons button:hover {
            background-color: #a8aed1;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(136, 143, 181, 0.1);
            text-align: center;
            transition: all 0.3s ease;
        }
        .risk-bar {
            height: 10px;
            background: linear-gradient(to right, green, yellow, red);
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }
        .risk-level {
            height: 100%;
            width: 0%;
            background-color: rgba(255, 255, 255, 0.3);
            transition: width 0.5s ease;
        }
        .history {
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            border-radius: 5px;
            background-color: rgba(136, 143, 181, 0.1);
        }
        .history-item {
            padding: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }
        .chart-container {
            margin-top: 20px;
            height: 150px;
            position: relative;
        }
        canvas {
            width: 100%;
            height: 100%;
            border-radius: 5px;
            background-color: rgba(136, 143, 181, 0.1);
        }
        .probability {
            margin-top: 10px;
            font-size: 0.9rem;
            text-align: center;
        }
        .footer {
            margin-top: 30px;
            text-align: center;
            padding: 15px;
            font-style: italic;
            border-top: 1px solid rgba(136, 143, 181, 0.3);
            width: 100%;
            max-width: 500px;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        /* –¢–µ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .dark-theme {
            background-color: #121212;
            color: #ffffff;
        }
        .dark-theme .theme-icon[data-theme="dark"] {
            background-color: #333;
            border-color: #888FB5;
        }
        /* –°–≤–µ—Ç–ª—ã–µ —Å—Ç–∏–ª–∏ */
        .light-theme {
            background-color: #f5f5f5;
            color: #121212;
        }
        .light-theme .theme-icon[data-theme="light"] {
            background-color: #FFD700;
            border-color: #FFA500;
        }
        .light-theme .input-group input, .light-theme .input-group select {
            background-color: rgba(255, 255, 255, 0.8);
        }
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–º—ã */
        .blue-theme {
            background-color: #1a237e;
            color: #ffffff;
        }
        .blue-theme .theme-icon[data-theme="blue"] {
            background-color: #2196F3;
            border-color: #64B5F6;
        }
        .green-theme {
            background-color: #1B5E20;
            color: #ffffff;
        }
        .green-theme .theme-icon[data-theme="green"] {
            background-color: #4CAF50;
            border-color: #81C784;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            .theme-selector {
                gap: 10px;
            }
            .theme-icon {
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–∫–æ–º</h1>
        <p>"–ü–∞—Å—Ç—É—Ö, –∏–º–µ–≤—à–∏–π –º–Ω–æ–≥–æ —Å–∫–æ—Ç–∞, –±—ã–ª –±–æ–≥–∞—Ç, –Ω–æ –æ–¥–Ω–∞–∂–¥—ã –µ–≥–æ —Å—Ç–∞–¥–æ —Ä–∞–∑–±–µ–∂–∞–ª–æ—Å—å. –û–Ω –ø–æ–Ω—è–ª, —á—Ç–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ –±–æ–≥–∞—Ç—Å—Ç–≤–æ –Ω–µ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ, –∞ –≤ —É–º–µ–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –ø—Ä–∏—É–º–Ω–æ–∂–∞—Ç—å."</p>
    </div>
    <div class="theme-selector">
        <div class="theme-icon active" data-theme="dark" onclick="switchTheme('dark')">üåô</div>
        <div class="theme-icon" data-theme="light" onclick="switchTheme('light')">‚òÄÔ∏è</div>
        <div class="theme-icon" data-theme="blue" onclick="switchTheme('blue')">üîµ</div>
        <div class="theme-icon" data-theme="green" onclick="switchTheme('green')">üåø</div>
    </div>
    <div class="container">
        <div class="input-group">
            <label for="bank">–¢–µ–∫—É—â–∏–π –±–∞–Ω–∫ (—Ä—É–±.):</label>
            <input type="number" id="bank" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="0">
        </div>
        <div class="input-group">
            <label for="bet">–°—Ç–∞–≤–∫–∞ (–º–∏–Ω. 10 —Ä—É–±., –º–∞–∫—Å. 50% –æ—Ç –±–∞–Ω–∫–∞):</label>
            <input type="number" id="bet" placeholder="10" min="10">
        </div>
        <div class="input-group">
            <label for="loss-streak">–ü–æ–ª–æ—Å–∞ –Ω–µ—É–¥–∞—á:</label>
            <input type="number" id="loss-streak" placeholder="0" min="0">
        </div>
        <div class="input-group">
            <label for="strategy">–°—Ç—Ä–∞—Ç–µ–≥–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</label>
            <select id="strategy">
                <option value="conservative">–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è (—É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 10%)</option>
                <option value="martingale">–ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª (—É–¥–≤–æ–µ–Ω–∏–µ)</option>
                <option value="fibonacci">–§–∏–±–æ–Ω–∞—á—á–∏</option>
                <option value="dalembert">–î'–ê–ª–∞–º–±–µ—Ä (+1 –ø—Ä–∏ –ø—Ä–æ–∏–≥—Ä—ã—à–µ)</option>
            </select>
        </div>
        <div class="buttons">
            <button onclick="calculate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            <button onclick="reset()">–°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>
        
        <div class="result" id="result">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
            <p id="result-text">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å"</p>
            <div class="risk-bar">
                <div class="risk-level" id="risk-level"></div>
            </div>
            <div class="probability" id="probability-text"></div>
        </div>
        
        <div class="chart-container">
            <canvas id="bank-chart"></canvas>
        </div>
        
        <div class="history">
            <h4>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h4>
            <div id="history-list"></div>
        </div>
    </div>
    
    <div class="footer">
        <p>"–ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ –∑–Ω–∞–Ω–∏—è, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —Å—Ç–∞–≤–∫–∏."</p>
        <p> ‚Äî –ú—É–¥—Ä—ã–π –∏–≥—Ä–æ–∫</p>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let operationHistory = JSON.parse(localStorage.getItem('bankHistory')) || [];
        let bankData = JSON.parse(localStorage.getItem('bankData')) || [];
        let chart = null;
        
        // –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        const strategies = {
            conservative: {
                name: "–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è",
                calculate: (bet, streak) => {
                    // –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –Ω–∞ 10% –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –Ω–µ—É–¥–∞—á–∏
                    return bet * Math.pow(0.9, streak);
                }
            },
            martingale: {
                name: "–ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª",
                calculate: (bet, streak) => {
                    // –£–¥–≤–æ–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –Ω–µ—É–¥–∞—á–∏
                    return bet * Math.pow(2, streak);
                }
            },
            fibonacci: {
                name: "–§–∏–±–æ–Ω–∞—á—á–∏",
                calculate: (bet, streak) => {
                    // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –§–∏–±–æ–Ω–∞—á—á–∏
                    const fib = [1, 1];
                    for (let i = 2; i <= streak; i++) {
                        fib[i] = fib[i-1] + fib[i-2];
                    }
                    return bet * (fib[streak] || 1);
                }
            },
            dalembert: {
                name: "–î'–ê–ª–∞–º–±–µ—Ä",
                calculate: (bet, streak) => {
                    // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 1 –µ–¥–∏–Ω–∏—Ü—É –ø–æ—Å–ª–µ –ø—Ä–æ–∏–≥—Ä—ã—à–∞
                    return bet + (streak * bet * 0.1);
                }
            }
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedData();
            updateHistoryDisplay();
            initializeChart();
        });
        
        function switchTheme(theme) {
            document.body.className = theme + '-theme';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∏–∫–æ–Ω–∫—É
            document.querySelectorAll('.theme-icon').forEach(icon => {
                icon.classList.remove('active');
            });
            document.querySelector(`.theme-icon[data-theme="${theme}"]`).classList.add('active');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä —Ç–µ–º—ã
            localStorage.setItem('selectedTheme', theme);
        }
        
        function loadSavedData() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
            const savedTheme = localStorage.getItem('selectedTheme') || 'dark';
            switchTheme(savedTheme);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const savedBank = localStorage.getItem('savedBank');
            const savedBet = localStorage.getItem('savedBet');
            const savedLossStreak = localStorage.getItem('savedLossStreak');
            const savedStrategy = localStorage.getItem('savedStrategy');
            
            if (savedBank) document.getElementById('bank').value = savedBank;
            if (savedBet) document.getElementById('bet').value = savedBet;
            if (savedLossStreak) document.getElementById('loss-streak').value = savedLossStreak;
            if (savedStrategy) document.getElementById('strategy').value = savedStrategy;
        }
        
        function saveData() {
            const bank = document.getElementById('bank').value;
            const bet = document.getElementById('bet').value;
            const lossStreak = document.getElementById('loss-streak').value;
            const strategy = document.getElementById('strategy').value;
            
            if (bank) localStorage.setItem('savedBank', bank);
            if (bet) localStorage.setItem('savedBet', bet);
            if (lossStreak) localStorage.setItem('savedLossStreak', lossStreak);
            if (strategy) localStorage.setItem('savedStrategy', strategy);
        }
        
        function calculate() {
            const bank = parseFloat(document.getElementById('bank').value);
            const bet = parseFloat(document.getElementById('bet').value);
            const lossStreak = parseInt(document.getElementById('loss-streak').value);
            const strategy = document.getElementById('strategy').value;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
            if (isNaN(bank) || isNaN(bet) || isNaN(lossStreak)) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (bank < 0) {
                showError('–ë–∞–Ω–∫ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º');
                return;
            }
            
            if (bet < 10) {
                showError('–°—Ç–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 10 —Ä—É–±–ª–µ–π');
                return;
            }
            
            // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ - 50% –æ—Ç –±–∞–Ω–∫–∞
            const maxBet = bank * 0.5;
            if (bet > maxBet) {
                showError(`–°—Ç–∞–≤–∫–∞ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å 50% –æ—Ç –±–∞–Ω–∫–∞ (${maxBet.toFixed(2)} —Ä—É–±.)`);
                return;
            }
            
            if (lossStreak < 0) {
                showError('–ü–æ–ª–æ—Å–∞ –Ω–µ—É–¥–∞—á –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π');
                return;
            }
            
            // –†–∞—Å—á–µ—Ç –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
            const strategyFn = strategies[strategy].calculate;
            let adjustedBet = strategyFn(bet, lossStreak);
            let totalLoss = 0;
            let currentBet = bet;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
            bankData = [bank];
            
            for (let i = 0; i < lossStreak; i++) {
                currentBet = strategyFn(bet, i);
                totalLoss += currentBet;
                bankData.push(bank - totalLoss);
            }
            
            const remainingBank = bank - totalLoss;
            const riskLevel = calculateRiskLevel(remainingBank, bank);
            const probability = calculateProbability(remainingBank, bank);
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            let resultText = `–ü–æ—Å–ª–µ ${lossStreak} –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫:\n`;
            resultText += `–¢–µ–∫—É—â–∏–π –±–∞–Ω–∫: ${remainingBank.toFixed(2)} —Ä—É–±.\n`;
            resultText += `–°—É–º–º–∞ –ø–æ—Ç–µ—Ä—å: ${totalLoss.toFixed(2)} —Ä—É–±.\n`;
            resultText += `–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç–∞–≤–∫–∞: ${adjustedBet.toFixed(2)} —Ä—É–±.\n`;
            resultText += `–°—Ç—Ä–∞—Ç–µ–≥–∏—è: ${strategies[strategy].name}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('result-text').textContent = resultText;
            document.getElementById('risk-level').style.width = riskLevel + '%';
            document.getElementById('probability-text').textContent = probability;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            document.getElementById('result').classList.add('fade-in');
            setTimeout(() => {
                document.getElementById('result').classList.remove('fade-in');
            }, 500);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –∏ –∏—Å—Ç–æ—Ä–∏—é
            updateChart();
            addToHistory(bank, bet, lossStreak, strategy, remainingBank, totalLoss);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            saveData();
        }
        
        function calculateRiskLevel(remainingBank, initialBank) {
            if (remainingBank <= 0) return 100;
            const lossPercentage = (initialBank - remainingBank) / initialBank * 100;
            return Math.min(100, Math.max(0, lossPercentage));
        }
        
        function calculateProbability(remainingBank, initialBank) {
            if (remainingBank <= 0) return "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–∞–∑–æ—Ä–µ–Ω–∏—è: 100%";
            
            const riskFactor = (initialBank - remainingBank) / initialBank;
            let probability;
            
            if (riskFactor < 0.2) {
                probability = 5;
            } else if (riskFactor < 0.4) {
                probability = 15;
            } else if (riskFactor < 0.6) {
                probability = 35;
            } else if (riskFactor < 0.8) {
                probability = 65;
            } else {
                probability = 85;
            }
            
            return `–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–∞–∑–æ—Ä–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏: ~${probability}%`;
        }
        
        function initializeChart() {
            const canvas = document.getElementById('bank-chart');
            const ctx = canvas.getContext('2d');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // –†–∏—Å—É–µ–º –ø—É—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫
            drawChart(ctx, []);
        }
        
        function updateChart() {
            const canvas = document.getElementById('bank-chart');
            const ctx = canvas.getContext('2d');
            
            // –û—á–∏—â–∞–µ–º canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –†–∏—Å—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
            drawChart(ctx, bankData);
        }
        
        function drawChart(ctx, data) {
            if (data.length === 0) {
                // –†–∏—Å—É–µ–º placeholder, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
                ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                
                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('–ì—Ä–∞—Ñ–∏–∫ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞', ctx.canvas.width / 2, ctx.canvas.height / 2);
                return;
            }
            
            const padding = 20;
            const chartWidth = ctx.canvas.width - padding * 2;
            const chartHeight = ctx.canvas.height - padding * 2;
            
            // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è
            const maxValue = Math.max(...data);
            const minValue = Math.min(...data);
            const valueRange = maxValue - minValue || 1; // –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
            
            // –†–∏—Å—É–µ–º –æ—Å—å Y
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, ctx.canvas.height - padding);
            ctx.stroke();
            
            // –†–∏—Å—É–µ–º –æ—Å—å X
            ctx.beginPath();
            ctx.moveTo(padding, ctx.canvas.height - padding);
            ctx.lineTo(ctx.canvas.width - padding, ctx.canvas.height - padding);
            ctx.stroke();
            
            // –†–∏—Å—É–µ–º –ª–∏–Ω–∏—é –≥—Ä–∞—Ñ–∏–∫–∞
            ctx.strokeStyle = '#888FB5';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let i = 0; i < data.length; i++) {
                const x = padding + (i / (data.length - 1 || 1)) * chartWidth;
                const y = ctx.canvas.height - padding - ((data[i] - minValue) / valueRange) * chartHeight;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            
            ctx.stroke();
            
            // –†–∏—Å—É–µ–º —Ç–æ—á–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
            ctx.fillStyle = '#888FB5';
            for (let i = 0; i < data.length; i++) {
                const x = padding + (i / (data.length - 1 || 1)) * chartWidth;
                const y = ctx.canvas.height - padding - ((data[i] - minValue) / valueRange) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function addToHistory(bank, bet, lossStreak, strategy, remainingBank, totalLoss) {
            const timestamp = new Date().toLocaleString();
            const historyItem = {
                timestamp,
                bank,
                bet,
                lossStreak,
                strategy,
                remainingBank,
                totalLoss
            };
            
            operationHistory.unshift(historyItem);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é 10 –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
            if (operationHistory.length > 10) {
                operationHistory = operationHistory.slice(0, 10);
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –≤ localStorage
            localStorage.setItem('bankHistory', JSON.stringify(operationHistory));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
            updateHistoryDisplay();
        }
        
        function updateHistoryDisplay() {
            const historyList = document.getElementById('history-list');
            historyList.innerHTML = '';
            
            if (operationHistory.length === 0) {
                historyList.innerHTML = '<div class="history-item">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—É—Å—Ç–∞</div>';
                return;
            }
            
            operationHistory.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <strong>${item.timestamp}</strong><br>
                    –ë–∞–Ω–∫: ${item.bank} —Ä—É–±. ‚Üí ${item.remainingBank.toFixed(2)} —Ä—É–±. 
                    (–ü–æ—Ç–µ—Ä–∏: ${item.totalLoss.toFixed(2)} —Ä—É–±.)
                `;
                historyList.appendChild(historyItem);
            });
        }
        
        function showError(message) {
            document.getElementById('result-text').textContent = message;
            document.getElementById('risk-level').style.width = '0%';
            document.getElementById('probability-text').textContent = '';
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏
            document.getElementById('result').classList.add('fade-in');
            setTimeout(() => {
                document.getElementById('result').classList.remove('fade-in');
            }, 500);
        }
        
        function reset() {
            document.getElementById('bank').value = '';
            document.getElementById('bet').value = '10';
            document.getElementById('loss-streak').value = '0';
            document.getElementById('strategy').value = 'conservative';
            document.getElementById('result-text').textContent = '–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å"';
            document.getElementById('risk-level').style.width = '0%';
            document.getElementById('probability-text').textContent = '';
            
            // –û—á–∏—â–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
            bankData = [];
            updateChart();
            
            // –û—á–∏—â–∞–µ–º localStorage (–∫—Ä–æ–º–µ —Ç–µ–º—ã –∏ –∏—Å—Ç–æ—Ä–∏–∏)
            localStorage.removeItem('savedBank');
            localStorage.removeItem('savedBet');
            localStorage.removeItem('savedLossStreak');
            localStorage.removeItem('savedStrategy');
        }
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        document.getElementById('bet').value = '10';
        document.getElementById('loss-streak').value = '0';
    </script>
</body>
</html>
